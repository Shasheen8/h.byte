---
title: Hack The Box Edition: Curling
date: Wed, 01 Sep 2021 05:00:00 +0000
---

The **Curling** challenge on *Hack The Box* involves compromising a vulnerable *Linux machine* at IP *10.10.10.150* to gain *privileged access* as the *root* user. This post details the strategy, tactics, and step-by-step process used to achieve this goal, culminating in a fun and engaging *capture-the-flag (CTF)* experience.

## Strategy

The primary objective is to *compromise* the target machine and escalate privileges to obtain *root* access.

> **Key Goal**: Gain unauthorized access to the system and retrieve the *root.txt* flag.

## Tactics

The approach involves a combination of *network reconnaissance*, *web exploitation*, *credential discovery*, and *privilege escalation*:

- Perform a *network scan* to identify open ports and services.
- Use tools like *nmap*, *Nikto*, and *dirb* to discover vulnerabilities.
- Exploit a *Joomla* service running on an *Apache* server.
- Leverage *credential discovery* and *password cracking* to gain initial access.
- Upload a *reverse shell* to establish a foothold.
- Escalate privileges by exploiting a *cron job* and *file misconfigurations*.

> **Key Insight**: Systematic enumeration and creative exploitation are critical for CTF success.

## Exploitation Process

The following steps outline the process to compromise the *Curling* machine:

1. **Network Reconnaissance**:
    - Used *nmap* to scan the target IP *10.10.10.150* for open ports and services.
    - **Findings**:
        - *Port 22*: Running an *SSH* service.
        - *Port 80*: Hosting an *Apache* server with a *Joomla* service.
    - Ran *Nikto* to scan for vulnerabilities in the web server.
    - Used *dirb* to enumerate accessible directories on the *Joomla* site.

2. **Web Enumeration**:
    - Discovered a *Cewl Curling* website running on the target.
    - Viewed the *source page* and found a file named *secrets.txt* and a username *Floris*.
    - The *secrets.txt* file contained a *hashed base64 text*.

3. **Credential Discovery**:
    - Decoded the *base64 text* from *secrets.txt*, revealing the password *Curling2018!* for user *Floris*.
    - Used *Burp Suite* to intercept a random *login request* to the *Joomla* site.
    - Performed a *Cluster Bomb Intruder attack* in *Burp Suite*:
        - **Username Payload**: Set to *Floris*.
        - **Password Payload**: Used a wordlist generated by *Cewl* from the *Cewl Curling* website blog.
    - Confirmed the password *Curling2018!* granted access to the *Joomla* control panel as *Floris*.

4. **Initial Access**:
    - Attempted to upload a *reverse PHP shell* via the control panel but was *unsuccessful*.
    - Accessed the *media directory* and used a *PHP upload script* to upload a *reverse TCP shell script*.
    - Linked the script to the *Protostar* theme directory used by the website.
    - Successfully uploaded the script and established a *reverse shell* using *netcat*.
    - Logged into the shell as the *www-data* user.
    > **Key Challenge**: Uploading the reverse shell required creative use of the media directory due to initial failures.

5. **Internal Enumeration**:
    - While exploring the machine as *www-data*, discovered a file named *password_backup* in the *Floris* userâ€™s directory.
    - The file contained a *hex dump*:
        ```plaintext
        [Hex dump contents, not provided in original input]
        ```
    - Decoded the *hex dump* using *CyberChef*, which revealed a *password.txt* file containing a password for the user *Floris*.

6. **User Access**:
    - Used the decoded password to log in to the machine via *SSH* as *Floris*.
    - Retrieved the *user.txt* flag from the home directory.
    - Investigated the *admin area* directory, which contained *input* and *report* files.
    - Examined the *report* file to find the *source code* of the main website page.

7. **Privilege Escalation**:
    - Uploaded the *reverse shell script* to the *Apache* web server and executed it on the machine.
    - Identified a *cron job* that periodically refreshed the website page.
    - Leveraged the *cron job* to execute the *reverse shell script*, successfully obtaining a *root* shell.
    - Retrieved the *root.txt* flag from the root directory.


> **Key Insight**: The cron job provided a critical escalation path by executing the malicious script.

## Tools Used

The following table summarizes the tools employed during the exploitation:

| Tool         | Purpose                                                   |
|--------------|-----------------------------------------------------------|
| *nmap*       | Network scanning for open ports and services              |
| *Nikto*      | Web server vulnerability scanning                         |
| *dirb*       | Directory enumeration on the web server                   |
| *Cewl*       | Generating wordlists from the website                     |
| *Burp Suite* | Intercepting login requests and brute-forcing credentials |
| *CyberChef*  | Decoding hex dump to retrieve password                    |
| *netcat*     | Establishing reverse shell connection                     |

## Final Thoughts

The **Curling** machine on *Hack The Box* is a *fantastic* medium-difficulty *CTF challenge*. It required a blend of *reverse engineering*, *web exploitation*, and *privilege escalation*. While uploading the *PHP script* and escalating privileges posed some challenges, the process was *engaging* and *rewarding*. This challenge highlights the importance of thorough *enumeration* and creative problem-solving in penetration testing.

> **Final Rating**: Medium difficulty, highly recommended for CTF enthusiasts!