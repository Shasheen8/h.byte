---
title: What is Javascript Prototype Pollution?
date: Thu, 05 Jan 2023 17:05:00 +0000
---
Prototype pollution is a vulnerability that can occur in JavaScript programs when an attacker can modify an object's prototype in such a way that it causes unintended behavior. This can potentially lead to security issues such as code injection, cross-site scripting (XSS), and denial of service (DoS) attacks.The prototype of an object in JavaScript is a property that refers to another object. When a new object is created, it automatically inherits the properties and methods of its prototype. This helpful feature allows developers to create new objects based on existing ones without defining all the properties and methods from scratch.However, if an attacker can modify an object's prototype, they can inject malicious code into the program. For example, they might add a new method to the object's prototype that executes arbitrary code. The program could then call this, potentially leading to code injection.

Example: 

let userInput = '__proto__.attack=function(){alert("Code injected!")};'

let obj = {}
eval(userInput)

obj.attack()  // Code injected!In this example, the `eval` function executes the string stored in userInput. This string contains a statement that modifies the prototype of the `obj` object by adding a new method called `attack`. When this method is called, it displays an alert message.This is an example of prototype pollution because the attacker was able to modify the prototype of the `obj` object through user input (the `userInput` variable). This could potentially lead to security vulnerabilities like code injection or cross-site scripting (XSS) attacks.To prevent this type of prototype pollution, it is essential to sanitize user input to ensure that it does not contain any malicious code. This can be done by using functions such as `encodeURI` or `escape`, which will encode special characters and prevent them from being interpreted as code. It is also important to validate user input to ensure it conforms to the expected format.Prototype pollution can occur in several ways. One standard method uses user input, such as form fields or query parameters. Suppose an attacker can manipulate these inputs in such a way that they can modify the prototype of an object. In that case, they may be able to exploit the vulnerability. To prevent prototype pollution, it is vital to sanitize user input to ensure that it does not contain malicious code. As mentioned in the above example, this can be done by using functions such as `encodeURI` or `escape`, which will encode special characters and prevent them from being interpreted as code.It is also important to validate user input to ensure it conforms to the expected format. For example, if a form field is expected to contain a number, the program should check that the input is indeed a number and not a random value before processing it. Developers can also use libraries or frameworks that provide built-in protection against prototype pollution. For example, the `lodash` library includes a function called `defaultsDeep` that can merge objects in a way that does not modify their prototypes.Overall, prototype pollution is a severe issue that can have serious consequences for the security of a JavaScript program. By taking steps to sanitize and validate user input and using libraries or frameworks that provide built-in protection, developers and security engineers can help prevent this type of vulnerability.